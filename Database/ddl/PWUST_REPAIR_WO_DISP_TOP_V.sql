CREATE OR REPLACE VIEW SFMFG.PWUST_REPAIR_WO_DISP_TOP_V AS
SELECT DISTINCT
       T2.SALES_ORDER,
       T.PART_NO,
       (SELECT TT.WORK_LOC FROM SFMFG.SFFND_WORK_LOC_DEF TT WHERE TT.LOCATION_ID = T.ASGND_LOCATION_ID) AS WORK_LOC,
       (SELECT CC.CUSTOMER_NUMBER FROM SFMFG.PWUST_INT_SAP_SM_ORDER CC WHERE CC.SALES_ORDER = T2.SALES_ORDER AND ROWNUM = 1) AS CUSTOMER_NO,
       (SELECT CC1.CUSTOMER_NAME FROM SFMFG.PWUST_INT_SAP_SM_ORDER CC1 WHERE CC1.SALES_ORDER = T2.SALES_ORDER AND ROWNUM = 1) CUSTOMER_DESC,
       (SELECT CC2.SERIAL_NO FROM SFMFG.PWUST_SALES_ORDER CC2 WHERE CC2.SALES_ORDER = T2.SALES_ORDER AND ROWNUM = 1) SERIAL_NO,
       T.SECURITY_GROUP AS SECURITY_GROUP,
       T.ORDER_STATUS,
       T.ORDER_NO,
       T2.TIME_STAMP,
       T2.PW_ORDER_TYPE
FROM SFMFG.SFWID_ORDER_DESC T, SFMFG.PWUST_SFWID_ORDER_DESC T2
WHERE T.ORDER_ID = T2.ORDER_ID
AND T2.PW_ORDER_TYPE IN ('REPAIR');
