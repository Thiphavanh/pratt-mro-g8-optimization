CREATE OR REPLACE VIEW PWUST_OVERHAUL_WO_DISP_TAB_V AS
SELECT  TT.SALES_ORDER AS SALES_ORDER,
        TT.PW_ORDER_NO AS ORDER_NO,
        T.PLAN_TITLE AS PLAN_TITLE,
        DECODE (PW_ALT_COUNT,0,1,NULL,1,PW_ALT_COUNT) AS ALT_NO,
        T.ORDER_STATUS AS ORDER_STATUS,
        TT.WORK_SCOPE AS WORK_SCOPE,
        (SELECT T3.WORKSCOPE_TITLE FROM PWUST_WORKSCOPE_DEF  T3
        WHERE T3.WORKSCOPE = T.UCF_ORDER_VCH5 AND T3.ENGINE_TYPE = T.PROGRAM AND T3.WORK_LOC = (SELECT T2.WORK_LOC FROM SFFND_WORK_LOC_DEF T2 WHERE T2.LOCATION_ID = T.ASGND_LOCATION_ID)) AS WORK_SCOPE_DESC,
        TT.SUPERIORNET AS SUPERIOR_NETWORK_ACTIVITY,
        (SELECT T4.SUPERIOR_NETWORK_ACT_DESC FROM  PWUST_NETWORK_DEF T4 WHERE T4.ENGINE_TYPE = T.PROGRAM AND T4.SUPERIOR_NETWORK_ACT = T.UCF_ORDER_VCH3 AND T4.SUB_NETWORK_ACT = T.UCF_ORDER_VCH4) AS SUP_NET_DESC,
        TT.SUBNET AS SUB_NETWORK_ACTIVITY,
        (SELECT T4.SUB_NETWORK_ACT_DESC FROM  PWUST_NETWORK_DEF T4 WHERE T4.ENGINE_TYPE = T.PROGRAM AND T4.SUPERIOR_NETWORK_ACT = T.UCF_ORDER_VCH3 AND T4.SUB_NETWORK_ACT = T.UCF_ORDER_VCH4) AS SUB_NET_DESC,
        T.ALT_STATUS AS ALT_STATUS ,
        T.ORDER_HOLD_STATUS AS ORDER_HOLD_STATUS,
        (SELECT T2.WORK_LOC FROM SFFND_WORK_LOC_DEF T2 WHERE T2.LOCATION_ID = T.ASGND_LOCATION_ID) AS  ASGND_WORK_LOC,
        TT.SALES_ORDER_CREATE_DATE AS CREATE_DATE,
        TT.SALES_ORDER_RELEASE_DATE AS RELEASE_DATE,
        TT.SALES_ORDER_CREATE_BY AS CREATE_BY,
        TT.PW_ORDER_TYPE AS ORDER_TYPE,
        T.PLAN_NO AS PLAN_NO,
        T.PART_NO AS PART_NO,
        T.PARENT_ORDER_ID AS PARENT_ORDER_ID,
        (SELECT T1.UPDT_USERID FROM SFWID_ALTERATION_DESC T1 WHERE T1.ALT_ID = T.ALT_ID and T1.ALT_REASON <> 'Execution Order') AS ALTERED_BY,
        (SELECT T1.ALT_REASON FROM SFWID_ALTERATION_DESC T1 WHERE T1.ALT_ID = T.ALT_ID and T1.ALT_REASON <> 'Execution Order') AS REASON_FOR_CHANGE,
        (SELECT T5.DATE_COMPLETED FROM SFWID_ORDER_ALTS_V T5,SFWID_ALTERATION_DESC T1 WHERE T5.ALT_ID = T.ALT_ID AND T5.ALT_ID = T1.ALT_ID and t1.alt_id=t.alt_id and T1.ALT_REASON <> 'Execution Order') AS DATE_COMPLETED,
         T.SECURITY_GROUP,
         TT.SALES_ORDER_RELEASED_BY AS RELEASED_BY,
        'DUMMY'  AS NEW_SALES_ORDER,
        'DUMMY'  AS NEW_ENGINE_TYPE,
        'DUMMY'  AS NEW_ENGINE_MODEL,
        'DUMMY'  AS NEW_SAP_WORK_LOC,
        'DUMMY'  AS NEW_WORK_SCOPE,
        T.ORDER_ID,
        T.PLAN_REVISION,
        T.UCF_PLAN_VCH3,
        t.ucf_order_vch11,
        t.ucf_order_vch12,
        t.UCF_ORDER_VCH14,
        T.ORDER_NO AS OOB_ORDER_NO
FROM SFWID_ORDER_DESC T, PWUST_SFWID_ORDER_DESC TT
WHERE T.ORDER_ID = TT.ORDER_ID
AND TT.PW_ORDER_TYPE IN ('OVERHAUL','SUPPLEMENTAL','SUB ORDER')
AND TT.SALES_ORDER IS NOT NULL
AND T.PROGRAM IS NOT NULL
AND T.ASGND_LOCATION_ID IS NOT NULL
AND TT.ENGINE_MODEL  IS NOT NULL;
