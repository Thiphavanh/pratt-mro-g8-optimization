INSERT INTO SFPL_ITEM_PROGRAM_DETAILS
("ITEM_ID","PROGRAM", "LOCATION_ID","STOCK_UOM","BATCH_SIZE","COMP_SERIAL_FLAG","COMP_LOT_FLAG",
"WO_SERIAL_FLAG","WO_LOT_FLAG","EXP_FLAG","SPOOL_FLAG","OPT_DC1_FLAG","OPT_DC2_FLAG","OPT_DC3_FLAG","OPT_DC4_FLAG",
"UPDT_USERID","TIME_STAMP","LAST_ACTION","UTILIZATION_RULE","TRACKABLE_FLAG","UID_ENTRY_NAME","UID_ITEM_FLAG",
"UID_ACQUISITION_CODE","QTY_ON_HAND","FLIGHT_HOURS","FLIGHT_DAYS","FLIGHT_CYCLES","STD_COST",
UCF_ITEM_PROG_DETAIL_VCH1,
UCF_ITEM_PROG_DETAIL_VCH2,
UCF_ITEM_PROG_DETAIL_VCH3,
UCF_ITEM_PROG_DETAIL_VCH4,
UCF_ITEM_PROG_DETAIL_VCH5,
UCF_ITEM_PROG_DETAIL_VCH6,
UCF_ITEM_PROG_DETAIL_VCH7,
UCF_ITEM_PROG_DETAIL_VCH9,
UCF_ITEM_PROG_DETAIL_VCH8,
UCF_ITEM_PROG_DETAIL_VCH10,
UCF_ITEM_PROG_DETAIL_VCH11,
UCF_ITEM_PROG_DETAIL_VCH12,
UCF_ITEM_PROG_DETAIL_VCH13,
UCF_ITEM_PROG_DETAIL_VCH14,
UCF_ITEM_PROG_DETAIL_VCH15,
UCF_ITEM_PROG_DETAIL_NUM1,
UCF_ITEM_PROG_DETAIL_NUM2,
UCF_ITEM_PROG_DETAIL_NUM3,
UCF_ITEM_PROG_DETAIL_NUM4,
UCF_ITEM_PROG_DETAIL_NUM5,
UCF_ITEM_PROG_DETAIL_DATE1,
UCF_ITEM_PROG_DETAIL_DATE2,
UCF_ITEM_PROG_DETAIL_DATE3,
UCF_ITEM_PROG_DETAIL_DATE4,
UCF_ITEM_PROG_DETAIL_DATE5,
UCF_ITEM_PROG_DETAIL_FLAG1,
UCF_ITEM_PROG_DETAIL_FLAG2,
UCF_ITEM_PROG_DETAIL_FLAG3,
UCF_ITEM_PROG_DETAIL_FLAG4,
UCF_ITEM_PROG_DETAIL_FLAG5,
UCF_ITEM_PROG_DETAIL_VCH255_1,
UCF_ITEM_PROG_DETAIL_VCH255_2,
UCF_ITEM_PROG_DETAIL_VCH255_3,
UCF_ITEM_PROG_DETAIL_VCH4000_1,
UCF_ITEM_PROG_DETAIL_VCH4000_2)
(select B.ITEM_ID,B.PROGRAM, 'ANY' AS "LOCATION_ID",B.STOCK_UOM,B.BATCH_SIZE,B.COMP_SERIAL_FLAG,B.COMP_LOT_FLAG,
B.WO_SERIAL_FLAG,B.WO_LOT_FLAG,B.EXP_FLAG,B.SPOOL_FLAG,B.OPT_DC1_FLAG,B.OPT_DC2_FLAG,B.OPT_DC3_FLAG,B.OPT_DC4_FLAG,
B.UPDT_USERID,B.TIME_STAMP,B.LAST_ACTION,B.UTILIZATION_RULE,B.TRACKABLE_FLAG,B.UID_ENTRY_NAME,B.UID_ITEM_FLAG,
B.UID_ACQUISITION_CODE,B.QTY_ON_HAND,B.FLIGHT_HOURS,B.FLIGHT_DAYS,B.FLIGHT_CYCLES,"STD_COST",
B.UCF_ITEM_PROG_DETAIL_VCH1,
B.UCF_ITEM_PROG_DETAIL_VCH2,
B.UCF_ITEM_PROG_DETAIL_VCH3,
B.UCF_ITEM_PROG_DETAIL_VCH4,
B.UCF_ITEM_PROG_DETAIL_VCH5,
B.UCF_ITEM_PROG_DETAIL_VCH6,
B.UCF_ITEM_PROG_DETAIL_VCH7,
B.UCF_ITEM_PROG_DETAIL_VCH9,
B.UCF_ITEM_PROG_DETAIL_VCH8,
B.UCF_ITEM_PROG_DETAIL_VCH10,
B.UCF_ITEM_PROG_DETAIL_VCH11,
B.UCF_ITEM_PROG_DETAIL_VCH12,
B.UCF_ITEM_PROG_DETAIL_VCH13,
B.UCF_ITEM_PROG_DETAIL_VCH14,
B.UCF_ITEM_PROG_DETAIL_VCH15,
B.UCF_ITEM_PROG_DETAIL_NUM1,
B.UCF_ITEM_PROG_DETAIL_NUM2,
B.UCF_ITEM_PROG_DETAIL_NUM3,
B.UCF_ITEM_PROG_DETAIL_NUM4,
B.UCF_ITEM_PROG_DETAIL_NUM5,
B.UCF_ITEM_PROG_DETAIL_DATE1,
B.UCF_ITEM_PROG_DETAIL_DATE2,
B.UCF_ITEM_PROG_DETAIL_DATE3,
B.UCF_ITEM_PROG_DETAIL_DATE4,
B.UCF_ITEM_PROG_DETAIL_DATE5,
B.UCF_ITEM_PROG_DETAIL_FLAG1,
B.UCF_ITEM_PROG_DETAIL_FLAG2,
B.UCF_ITEM_PROG_DETAIL_FLAG3,
B.UCF_ITEM_PROG_DETAIL_FLAG4,
B.UCF_ITEM_PROG_DETAIL_FLAG5,
B.UCF_ITEM_PROG_DETAIL_VCH255_1,
B.UCF_ITEM_PROG_DETAIL_VCH255_2,
B.UCF_ITEM_PROG_DETAIL_VCH255_3,
B.UCF_ITEM_PROG_DETAIL_VCH4000_1,
B.UCF_ITEM_PROG_DETAIL_VCH4000_2
FROM SFPL_ITEM_DESC A, SFPL_ITEM_PROGRAM_DETAILS B
WHERE b.item_id = a.item_id
AND NVL(A.ITEM_SUBTYPE,'X') != 'STDOPER'
AND A.ITEM_ID != 'N/A'
AND A.PROGRAM = 'ANY'
AND A.ITEM_TYPE = 'PART'
AND ((a.work_loc <> 'ANY') and not exists (select 1 from SFPL_ITEM_DESC i where a.item_id = i.item_id and i.work_loc = 'ANY'))
and not exists (select 1 from SFPL_ITEM_DESC i where a.item_id = i.item_id and a.work_loc <> i.work_loc));

